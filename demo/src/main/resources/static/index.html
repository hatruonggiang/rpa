<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogDevice Data Table</title>
    <link rel="stylesheet" href="style.css">
    <style>

    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 LogDevice Data Table</h1>
            <p>Bảng dữ liệu thiết bị LogDevice</p>
        </div>

        <div class="controls">
            <div class="info">
                <input type="date" id="datePicker" style="margin-right:15px;" onchange="loadData()">
                <!-- <button onclick="refreshData()" style="padding: 8px 16px; margin-right: 15px; border: none; background: #4CAF50; color: white; border-radius: 4px; cursor: pointer; font-size: 14px;">🔄 Làm mới</button> -->
                <button onclick="showStatistics()" style="padding: 8px 16px; margin-right: 15px; border: none; background: #2196F3; color: white; border-radius: 4px; cursor: pointer; font-size: 14px;">📊 Thống kê</button>
                <button onclick="showAnalysis2()" style="padding: 8px 16px; margin-right: 15px; border: none; background: #FF9800; color: white; border-radius: 4px; cursor: pointer; font-size: 14px;">📈 Phân tích 2</button>
                <div class="dropdown" style="display: inline-block; position: relative;">
                    <button onclick="toggleExportMenu()" style="padding: 8px 16px; margin-right: 15px; border: none; background: #9C27B0; color: white; border-radius: 4px; cursor: pointer; font-size: 14px;">📥 Xuất Excel ▼</button>
                    <div id="exportMenu" class="dropdown-content" style="display: none; position: absolute; background: white; min-width: 200px; box-shadow: 0px 8px 16px rgba(0,0,0,0.2); z-index: 1; border-radius: 4px;">
                        <a onclick="exportData()" style="color: black; padding: 12px 16px; text-decoration: none; display: block; cursor: pointer;">📄 Dữ liệu ngày</a>
                        <a onclick="exportStat1()" style="color: black; padding: 12px 16px; text-decoration: none; display: block; cursor: pointer;">📊 Thống kê phân tích</a>
                        <a onclick="exportStat2()" style="color: black; padding: 12px 16px; text-decoration: none; display: block; cursor: pointer;">📈 Phân tích Log</a>
                        <a onclick="exportAll()" style="color: black; padding: 12px 16px; text-decoration: none; display: block; cursor: pointer; border-top: 1px solid #ddd;">📦 Tải tất cả</a>
                    </div>
                </div>
                <span id="recordCount">Tổng: 0 bản ghi</span>
            </div>
        </div>

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th class="col-id">_id</th>
                        <th class="col-serial">serial</th>
                        <th class="col-device-code">deviceCode</th>
                        <th class="col-device-type">deviceType</th>
                        <th class="col-mac">macHc</th>
                        <th class="col-fw-version">fwVersion</th>
                        <th class="col-status">statusTestCase</th>
                        <th class="col-type">type</th>
                        <th class="col-cmd">cmd</th>
                        <th class="col-rqi">rqi</th>
                        <th class="col-log">log</th>
                        <th class="col-time">createdTime</th>
                        <th class="col-time">updatedTime</th>
                        <th class="col-class">_class</th>
                    </tr>
                </thead>
                <tbody id="dataTableBody">
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Modal cho thống kê -->
    <div id="statisticsModal" class="modal">
        <div class="modal-content-large">
            <span class="close" onclick="closeStatistics()">&times;</span>
            <h2>📊 Thống kê phân tích theo DeviceCode và MAC</h2>
            <div id="statisticsContent">
                <div class="loading">⏳ Đang phân tích dữ liệu...</div>
            </div>
        </div>
    </div>

    <!-- Modal cho phân tích 2 -->
    <div id="analysis2Modal" class="modal">
        <div class="modal-content-large">
            <span class="close" onclick="closeAnalysis2()">&times;</span>
            <h2>📈 Phân tích Log theo MAC Address</h2>
            <div id="analysis2Content">
                <div class="loading">⏳ Đang phân tích dữ liệu...</div>
            </div>
        </div>
    </div>

<script src="script.js"></script>
</body>
</html>